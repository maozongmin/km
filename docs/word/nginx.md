# nginx å¸¸ç”¨å‘½ä»¤

```nginx
    start nginx         # å¯åŠ¨
Â Â Â Â nginx -s stopÂ Â Â Â Â Â  # å¿«é€Ÿå…³é—­Nginxï¼Œå¯èƒ½ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿…é€Ÿç»ˆæ­¢webæœåŠ¡ã€‚
Â Â Â Â nginx -s quitÂ Â Â Â Â Â  # å¹³ç¨³å…³é—­Nginxï¼Œä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å®‰æ’çš„ç»“æŸwebæœåŠ¡ã€‚
Â Â Â Â nginx -s reloadÂ Â Â Â  # ä¿®æ”¹é…ç½®åé‡æ–°åŠ è½½ç”Ÿæ•ˆã€‚
Â Â Â Â nginx -s reopenÂ Â Â Â  # é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ã€‚
Â Â Â Â nginx -c filenameÂ Â  # ä¸º Nginx æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥ä»£æ›¿ç¼ºçœçš„ã€‚
Â Â Â Â nginx -tÂ Â Â Â Â Â Â Â Â Â Â  # é…ç½®æ–‡ä»¶æ£€æµ‹æ˜¯å¦æ­£ç¡®

Â Â Â Â nginx -vÂ Â Â Â Â Â Â Â Â Â Â  # æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ã€‚

Â Â Â Â nginx -VÂ Â Â Â Â Â Â Â Â Â Â  # æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨ç‰ˆæœ¬å’Œé…ç½®å‚æ•°ã€‚

    service nginx stop  # åœæ­¢
    service nginx start # å¯åŠ¨
    service nginx restart   # é‡å¯
```

## nginx æ— æ³•å…³é—­

### å¦‚æœæ— æ³•å…³é—­ ngixn å¯ä»¥è¯•ä¸‹ä¸‹åˆ—æ–¹æ¡ˆ

```
    å‘½ä»¤è¡Œè¾“å…¥ï¼š taskkill /F /IM nginx.exe > nul
```

## 403 æ— æƒé™é—®é¢˜

    å°†æ•´ä¸ªè™šæ‹Ÿä¸»æœºå¼€å¯ç›®å½•æµé‡
    åœ¨location ä¸­åŠ ä¸Šautoindexä¸ºon;

```nginx
    location / {
            root   C:\xampp\htdocs;
            index  index.html index.htm;
            autoindex on;
    }
```

## ä»£ç†åˆ° 8080 ç«¯å£ï¼ˆproxy_passï¼‰

```nginx
location / {
    proxy_pass http://127.0.0.1:8080;
}
```

## nginx é…ç½® https

> ç­¾ç½²ç¬¬ä¸‰æ–¹å¯ä¿¡ä»»çš„ SSL è¯ä¹¦ å’Œ é…ç½® HTTPS

-   ç­¾ç½²ç¬¬ä¸‰æ–¹å¯ä¿¡ä»»çš„ SSL è¯ä¹¦

    xxx.pemã€xxx.crt ä¸ºè¯ä¹¦æ–‡ä»¶ï¼Œxxx.key ä¸ºå¯†é’¥æ–‡ä»¶ï¼Œéœ€è‡ªè¡Œä¸‹è½½

-   é…ç½® https
    > è¦å¼€å¯ HTTPS æœåŠ¡ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¿¡æ¯å—(server)ï¼Œå¿…é¡»ä½¿ç”¨ç›‘å¬å‘½ä»¤ `listen` çš„ `ssl` å‚æ•°å’Œå®šä¹‰æœåŠ¡å™¨è¯ä¹¦æ–‡ä»¶å’Œç§é’¥æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```nginx
server {
    listen 443;
    server_name www.xxx.com; // ä½ çš„åŸŸå
    root /var/www/www.xxx.com; // å‰å°æ–‡ä»¶å­˜æ”¾æ–‡ä»¶å¤¹ï¼Œå¯æ”¹æˆåˆ«çš„
    index index.html index.htm;// ä¸Šé¢é…ç½®çš„æ–‡ä»¶å¤¹é‡Œé¢çš„index.html

    ssl on;
    ssl_certificate  xxx.pem;// æ”¹æˆä½ çš„è¯ä¹¦çš„åå­—
    ssl_certificate_key xxx.key;// ä½ çš„å¯†é’¥çš„åå­—
    ssl_session_timeout 5m;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; #æŒ‰ç…§è¿™ä¸ªåè®®é…ç½® è¿™é‡Œä¸éœ€è¦æ›´æ”¹
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2; // æŒ‰ç…§è¿™ä¸ªåè®®é…ç½® è¿™é‡Œä¸éœ€è¦æ›´æ”¹
    ssl_prefer_server_ciphers on;

    location / {
        index index.html index.htm;
    }
}
```

### http è‡ªåŠ¨è·³è½¬ httpsï¼ˆå¯é€‰ï¼‰

::: warning
è¦æ–°åŠ ä¸€ä¸ª server ä¸è¦å†™åœ¨ listen 443 é‡Œé¢ï¼Œå†™åœ¨é‡Œé¢å°±ä¸€ç›´æ˜¯ https é‡å®šå‘åˆ° httpsï¼Œè¿›å…¥æ­»å¾ªç¯ã€‚
:::

```nginx
server {
    listen 80;
    server_name www.xxx.com;// ä½ çš„åŸŸå
    rewrite ^(.*)$ https://$host$1 permanent;// æŠŠhttpçš„åŸŸåè¯·æ±‚è½¬æˆhttps
}
```

| é…ç½®æ–‡ä»¶å‚æ•°        | è¯´æ˜                                |
| ------------------- | ----------------------------------- |
| listen 443          | SSL è®¿é—®ç«¯å£å·ä¸º 443                |
| ssl on              | å¯ç”¨ SSL åŠŸèƒ½                       |
| ssl_certificate     | è¯ä¹¦æ–‡ä»¶                            |
| ssl_certificate_key | ç§é’¥æ–‡ä»¶                            |
| ssl_protocols       | ä½¿ç”¨çš„åè®®                          |
| ssl_ciphers         | é…ç½®åŠ å¯†å¥—ä»¶ï¼Œå†™æ³•éµå¾ª openssl æ ‡å‡† |

## äºŒçº§ç›®å½•åå‘ä»£ç†

<a href="https://zhang.ge/5054.html" target="_blank">Nginx é€šè¿‡äºŒçº§ç›®å½•ï¼ˆè·¯å¾„ï¼‰æ˜ å°„ä¸åŒçš„åå‘ä»£ç†ï¼Œè§„é¿ IP+ç«¯å£è®¿é—®</a>

## Dos å‘½ä»¤æŸ¥çœ‹ç«¯å£å ç”¨åŠå…³é—­è¿›ç¨‹

### æŸ¥çœ‹ç«¯å£å ç”¨

åœ¨ windows å‘½ä»¤è¡Œçª—å£ä¸‹æ‰§è¡Œï¼š
`netstat -aon|findstr "8080"`

```
TCP     127.0.0.1:80         0.0.0.0:0               LISTENING       2448
```

ç«¯å£â€œ8080â€è¢« PIDï¼ˆè¿›ç¨‹å·ï¼‰ä¸º 2448 çš„è¿›ç¨‹å ç”¨ã€‚

æŸ¥çœ‹ç«¯å£â€œ8080â€è¢«å“ªä¸ªåº”ç”¨å ç”¨ï¼Œç»§ç»­æ‰§è¡Œå‘½ä»¤ï¼š
`tasklist|findstr "2448"`

```
notepad.exe                     2016 Console                 0     16,064 K
```

### å…³é—­è¿›ç¨‹

1. æŒ‰è¿›ç¨‹å·å…³é—­è¿›ç¨‹  
   `taskkill /pid 2152`  
   å¤šä¸ªæ—¶æ ¼å¼ä¸ºï¼š`taskkill /pid 2152 /pid 1284`

2. æŒ‰è¿›ç¨‹åå…³é—­è¿›ç¨‹
   `taskkill /im nginx.exe`  
   æŒ‡å®šå¤šä¸ªæ—¶æ ¼å¼ä¸ºï¼š
   `taskkill /im notepad.exe /im iexplorer.exe`

3. æœ‰æç¤ºçš„å…³é—­è¿›ç¨‹

```
taskkill /t /im notepad.exe
taskkill /t /pid 2152
```

4. å¼ºè¡Œç»ˆæ­¢è¿›ç¨‹

```
taskkill /f /im notepad.exe
taskkill /f /pid 2152
```

## nginx é‚£äº›äº‹

<img src="../.vuepress/public/img/nginx.png" />

> nginx æ—¢å¯ä»¥ä½œä¸º Web æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œå…·å¤‡é«˜æ€§èƒ½ã€é«˜å¹¶å‘è¿æ¥ç­‰

### è´Ÿè½½å‡è¡¡

> å½“ä¸€ä¸ªåº”ç”¨å•ä½æ—¶é—´å†…è®¿é—®é‡æ¿€å¢ï¼ŒæœåŠ¡å™¨çš„å¸¦å®½åŠæ€§èƒ½å—åˆ°å½±å“ï¼Œå½±å“å¤§åˆ°è‡ªèº«æ‰¿å—èƒ½åŠ›æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šå®•æœºå¥”æºƒï¼Œä¸ºäº†é˜²æ­¢è¿™ç§ç°è±¡å‘ç”Ÿï¼Œä»¥åŠå®ç°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½® `Nginx` è´Ÿè½½å‡è¡¡çš„æ–¹å¼æ¥åˆ†æ‹…æœåŠ¡å™¨å‹åŠ›

> å½“æœ‰ä¸€å°æœåŠ¡å™¨å®•æœºæ—¶ï¼Œè´Ÿè½½å‡è¡¡å™¨å°±åˆ†é…å…¶ä»–çš„æœåŠ¡å™¨ç»™ç”¨æˆ·ï¼Œæå¤§çš„å¢åŠ çš„ç½‘ç«™çš„ç¨³å®šæ€§ å½“ç”¨æˆ·è®¿é—® web æ—¶å€™ï¼Œé¦–å…ˆè®¿é—®åˆ°çš„æ˜¯`è´Ÿè½½å‡è¡¡å™¨`ï¼Œå†é€šè¿‡è´Ÿè½½å‡è¡¡å™¨å°†è¯·æ±‚è½¬å‘ç»™åå°æœåŠ¡å™¨

#### è´Ÿè½½å‡è¡¡çš„å‡ ç§å¸¸ç”¨æ–¹å¼

-   è½®è¯¢ï¼ˆé»˜è®¤ï¼‰

```nginx
# nginx.config
upstream backserver {
  server 192.168.0.1;
  server 192.168.0.2;
}
```

-   æƒé‡ weight
    æŒ‡å®šä¸åŒ ip çš„æƒé‡ï¼Œæƒé‡ä¸è®¿é—®æ¯”æˆæ­£ç›¸å…³ï¼Œæƒé‡è¶Šé«˜ï¼Œè®¿é—®è¶Šå¤§ï¼Œé€‚ç”¨äºä¸åŒæ€§èƒ½çš„æœºå™¨

```nginx
# nginx.config
upstream backserver {
  server 192.168.0.1 weight=2;
  server 192.168.0.2 weight=8;
}
```

-   å“åº”æ—¶é—´æ¥åˆ†é…
    å…¬å¹³ç«äº‰ï¼Œè°ç›¸åº”å¿«ï¼Œè°å¤„ç†ï¼Œä¸è¿‡è¿™ç§æ–¹å¼éœ€è¦ä¾èµ–åˆ°ç¬¬ä¸‰æ–¹æ’ä»¶ nginx-upstream-fairï¼Œéœ€è¦å…ˆå®‰è£…

```nginx
# nginx.config
upstream backserver {
  server 192.168.0.1;
  server 192.168.0.2;
  fair;
}

server {
  listen 80;
  server_name localhost;
  location / {
    proxy_pass  http://backserver;
  }
}
```

#### å¥åº·æ£€æŸ¥

Nginx è‡ªå¸¦ `ngx_http_upstream_module`ï¼ˆå¥åº·æ£€æµ‹æ¨¡å—ï¼‰æœ¬è´¨ä¸ŠæœåŠ¡å™¨å¿ƒè·³çš„æ£€æŸ¥ï¼Œé€šè¿‡å®šæœŸè½®è¯¢å‘é›†ç¾¤é‡Œçš„æœåŠ¡å™¨å‘é€å¥åº·æ£€æŸ¥è¯·æ±‚,æ¥æ£€æŸ¥é›†ç¾¤ä¸­æ˜¯å¦æœ‰æœåŠ¡å™¨å¤„äºå¼‚å¸¸çŠ¶æ€

å¦‚æœæ£€æµ‹å‡ºå…¶ä¸­æŸå°æœåŠ¡å™¨å¼‚å¸¸,é‚£ä¹ˆåœ¨é€šè¿‡å®¢æˆ·ç«¯è¯·æ±‚ nginx åå‘ä»£ç†è¿›æ¥çš„éƒ½ä¸ä¼šè¢«å‘é€åˆ°è¯¥æœåŠ¡å™¨ä¸Šï¼ˆç›´è‡³ä¸‹æ¬¡è½®è®­å¥åº·æ£€æŸ¥æ­£å¸¸ï¼‰

åŸºæœ¬ä¾‹å­å¦‚ä¸‹ ğŸ‘‡

```nginx
upstream backserver{
  server 192.168.0.1  max_fails=1 fail_timeout=40s;
  server 192.168.0.2  max_fails=1 fail_timeout=40s;
}

server {
  listen 80;
  server_name localhost;
  location / {
    proxy_pass http://backend;
  }
}
```

æ¶‰åŠä¸¤ä¸ªé…ç½®ï¼š

`fail_timeout` : è®¾å®šæœåŠ¡å™¨è¢«è®¤ä¸ºä¸å¯ç”¨çš„æ—¶é—´æ®µä»¥åŠç»Ÿè®¡å¤±è´¥å°è¯•æ¬¡æ•°çš„æ—¶é—´æ®µï¼Œé»˜è®¤ä¸º 10s  
`max_fails` : è®¾å®š Nginx ä¸æœåŠ¡å™¨é€šä¿¡çš„å°è¯•å¤±è´¥çš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸ºï¼š1 æ¬¡

### åå‘ä»£ç†

> åå‘ä»£ç†æŒ‡çš„æ˜¯ï¼Œå½“ä¸€ä¸ªå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚,æƒ³è¦è®¿é—®æœåŠ¡å™¨ä¸Šçš„å†…å®¹ï¼Œä½†å°†è¢«è¯¥è¯·æ±‚å…ˆå‘é€åˆ°ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ `proxy`,è¿™ä¸ªä»£ç†æœåŠ¡å™¨ï¼ˆ`Nginx`ï¼‰å°†æŠŠè¯·æ±‚ä»£ç†åˆ°å’Œè‡ªå·±å±äºåŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹çš„å†…éƒ¨æœåŠ¡å™¨ä¸Š,è€Œç”¨æˆ·é€šè¿‡å®¢æˆ·ç«¯çœŸæ­£æƒ³è·å¾—çš„å†…å®¹å°±å­˜å‚¨åœ¨è¿™äº›å†…éƒ¨æœåŠ¡å™¨ä¸Šï¼Œæ­¤æ—¶ `Nginx` ä»£ç†æœåŠ¡å™¨æ‰¿æ‹…çš„è§’è‰²å°±æ˜¯ä¸€ä¸ªä¸­é—´äººï¼Œèµ·åˆ°åˆ†é…å’Œæ²Ÿé€šçš„ä½œç”¨

#### åå‘ä»£ç†ä¼˜åŠ¿

-   é˜²ç«å¢™ä½œç”¨  
    å½“ä½ çš„åº”ç”¨ä¸æƒ³ç›´æ¥æš´éœ²ç»™å®¢æˆ·ç«¯ï¼ˆä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ— æ³•ç›´æ¥é€šè¿‡è¯·æ±‚è®¿é—®çœŸæ­£çš„æœåŠ¡å™¨ï¼Œåªèƒ½é€šè¿‡ Nginxï¼‰ï¼Œé€šè¿‡ `nginx` è¿‡æ»¤æ‰æ²¡æœ‰æƒé™æˆ–è€…éæ³•çš„è¯·æ±‚ï¼Œæ¥ä¿éšœå†…éƒ¨æœåŠ¡å™¨çš„å®‰å…¨

-   è´Ÿè½½å‡è¡¡  
    ä¹Ÿå°±ä¸Šä¸€ç« æåˆ°è´Ÿè½½å‡è¡¡ï¼Œæœ¬è´¨ä¸Šè´Ÿè½½å‡è¡¡å°±æ˜¯åå‘ä»£ç†çš„ä¸€ç§åº”ç”¨åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡ `nginx` å°†æ¥æ”¶åˆ°çš„å®¢æˆ·ç«¯è¯·æ±‚"å‡åŒ€åœ°"åˆ†é…åˆ°è¿™ä¸ªé›†ç¾¤ä¸­æ‰€æœ‰çš„æœåŠ¡å™¨ä¸Š(å…·ä½“çœ‹è´Ÿè½½å‡è¡¡æ–¹å¼),ä»è€Œå®ç°æœåŠ¡å™¨å‹åŠ›çš„è´Ÿè½½å‡è¡¡

#### å¦‚ä½•ä½¿ç”¨åå‘ä»£ç†

```nginx
# æˆ‘ä»¬é€šè¿‡æ¨¡æ‹Ÿå†…éƒ¨æœåŠ¡å™¨çš„ç«¯å£å¯åŠ¨çš„nodejsé¡¹ç›®è®¾ç½®åå‘ä»£ç†åˆ°80ç«¯å£è®¿é—®
# nginx.config
server  {
  listen 80;
  server_name localhost;
  location / {
    proxy_pass http://127.0.0.1:8000; #ï¼ˆupstreamï¼‰
  }
}
```

åœ¨ Nginx åå‘ä»£ç†æ˜¯ï¼Œä¼šé€šè¿‡ location åŠŸèƒ½åŒ¹é…æŒ‡å®šçš„ URIï¼Œç„¶åæŠŠæ¥æ”¶åˆ°çš„ç¬¦åˆåŒ¹é… `URI` çš„è¯·æ±‚é€šè¿‡ `proxy_pass` è½¬ç§»ç»™ä¹‹å‰å®šä¹‰å¥½çš„ upstream èŠ‚ç‚¹æ± 

### å¸¸ç”¨é…ç½®

#### IP ç™½åå•

> å¯ä»¥é…ç½® nginx çš„ç™½åå•ï¼Œè§„å®šæœ‰å“ªäº› ip å¯ä»¥è®¿é—®ä½ çš„æœåŠ¡å™¨ï¼Œé˜²çˆ¬è™«å¿…å¤‡

```nginx
# ç®€å•é…ç½®
server {
  location / {
    deny  192.168.0.1; # ç¦æ­¢è¯¥ipè®¿é—®
    deny  all; # ç¦æ­¢æ‰€æœ‰
  }
}
```

ç™½åå•é…ç½®
å»ºç«‹ç™½åå•

vim /etc/nginx/white_ip.conf
...
192.168.0.1 1;
...
ä¿®æ”¹ nginx é…ç½®(nginx.conf)

geo $remote_addr $ip_whitelist{
default 0;
include ip.conf;
}
// geo æŒ‡ä»¤ä¸»è¦æ˜¯å¯ä»¥æ ¹æ®æŒ‡å®šå˜é‡çš„å€¼æ˜ å°„å‡ºä¸€ä¸ªæ–°å˜é‡ã€‚å¦‚æœä¸æŒ‡å®šå˜é‡ï¼Œé»˜è®¤ä¸º`$remote_addr`
ä¸ºåŒ¹é…é¡¹åšç™½åå•è®¾ç½®

server {
location / {
if ( $ip_whitelist = 0 ){
      return 403; //ä¸åœ¨ç™½åå•è¿”å› 403
    }
    index index.html;
    root /tmp;
  }
}
4.2 é€‚é…PCä¸ç§»åŠ¨ç¯å¢ƒ
å½“ç”¨æˆ·ä»ç§»åŠ¨ç«¯æ‰“å¼€PCç«¯baidu.comçš„åœºæ™¯æ—¶ï¼Œå°†è‡ªåŠ¨è·³è½¬æŒ‡ç§»åŠ¨ç«¯m.baidu.comï¼Œæœ¬è´¨ä¸Šæ˜¯Nginxå¯ä»¥é€šè¿‡å†…ç½®å˜é‡$http_user_agentï¼Œè·å–åˆ°è¯·æ±‚å®¢æˆ·ç«¯çš„ userAgentï¼Œä»è€ŒçŸ¥é“å½“å‰ç”¨æˆ·å½“å‰ç»ˆç«¯æ˜¯ç§»åŠ¨ç«¯è¿˜æ˜¯ PCï¼Œè¿›è€Œé‡å®šå‘åˆ° H5 ç«™è¿˜æ˜¯ PC ç«™

server {
location / {
//ç§»åŠ¨ã€pc è®¾å¤‡ agent è·å–
if ($http_user_agent ~* '(Android|webOS|iPhone)') {
      set $mobile_request '1';
}
if (\$mobile_request = '1') {
rewrite ^.+ http://m.baidu.com;
}
}
}
4.3 é…ç½® gzip
å¼€å¯ Nginx gzipï¼Œå‹ç¼©å,é™æ€èµ„æºçš„å¤§å°ä¼šå¤§å¤§çš„å‡å°‘,ä»è€Œå¯ä»¥èŠ‚çº¦å¤§é‡çš„å¸¦å®½,æé«˜ä¼ è¾“æ•ˆç‡,å¸¦æ¥æ›´å¥½çš„å“åº”å’Œä½“éªŒ

server{
gzip on; //å¯åŠ¨
gzip_buffers 32 4K;
gzip_comp_level 6; //å‹ç¼©çº§åˆ«ï¼Œ1-10ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©çš„è¶Šå¥½
gzip_min_length 100; //ä¸å‹ç¼©ä¸´ç•Œå€¼ï¼Œå¤§äº 100 çš„æ‰å‹ç¼©ï¼Œä¸€èˆ¬ä¸ç”¨æ”¹
gzip_types application/javascript text/css text/xml;
gzip_disable "MSIE [1-6]\."; // IE6 å¯¹ Gzip ä¸å‹å¥½ï¼Œå¯¹ Gzip
gzip_vary on;
}
4.4 Nginx é…ç½®è·¨åŸŸè¯·æ±‚
å½“å‡ºç° 403 è·¨åŸŸé”™è¯¯çš„æ—¶å€™ï¼Œè¿˜æœ‰ No 'Access-Control-Allow-Origin' header is present on the requested resource æŠ¥é”™ç­‰ï¼Œéœ€è¦ç»™ Nginx æœåŠ¡å™¨é…ç½®å“åº”çš„ header å‚æ•°ï¼š

location / {
add_header Access-Control-Allow-Origin \*;
add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';

if (\$request_method = 'OPTIONS') {
return 204;
}
} 5.å¦‚ä½•ä½¿ç”¨ Nginx
é€šè¿‡åœ¨æœ¬åœ°ä½¿ç”¨ Nginxï¼Œä»å¯åŠ¨ã€æ›´æ”¹ã€é‡å¯ç­‰ç¯èŠ‚æ¥ä»‹ç» Nginx çš„åŸºæœ¬ä½¿ç”¨

å¦‚ä½•å¯åŠ¨ sudo nginx
ä¿®æ”¹ nginx.conf é…ç½® (å…·ä½“çœ‹ä½ é…ç½®ä½ç½®)vim /usr/local/etc/nginx/nginx.conf
æ£€æŸ¥è¯­æ³•æ˜¯å¦æ­£å¸¸ sudo nginx -t
é‡å¯ nginx sudo nginx -s reload
åˆ›å»ºè½¯é“¾æ¥(ä¾¿äºç®¡ç†å¤šåº”ç”¨ nginx)
å½“æˆ‘ä»¬éœ€è¦ç®¡ç†å¤šä¸ªç½‘ç«™çš„ nginxï¼Œnginx æ–‡ä»¶æ”¾åœ¨ä¸€èµ·æ˜¯æœ€å¥½çš„ç®¡ç†æ–¹å¼ï¼Œä¸€èˆ¬éƒ½å­˜åœ¨/nginx/conf.d/ï¼Œæˆ‘ä»¬éœ€è¦æŠŠé…ç½®æ–‡ä»¶ä¸¢åˆ° /etc/nginx/conf.d/ æ–‡ä»¶å¤¹ä¸‹ï¼Œæ€æ ·æ‰èƒ½ä½¿è¿™ä¸ªé…ç½®æ–‡ä»¶æ—¢åœ¨ç¨‹åºæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆåœ¨ /etc/nginx/conf.d/æ–‡ä»¶å¤¹ä¸‹å‘¢ï¼Ÿ

å‡å¦‚æˆ‘ä»¬åœ¨ç¨‹åºæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ª ngxin é…ç½®æ–‡ä»¶ï¼š/home/app/app.nginx.conf æˆ‘ä»¬éœ€è¦ç»™è¿™ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥åˆ° /etc/nginx/conf.d/ ä¸‹ï¼š

ln -s /home/app/app.example.com.nginx.conf /etc/nginx/conf.d/app.nginx.conf
è¿™æ ·æ“ä½œä¹‹åï¼Œå½“æˆ‘ä»¬æ”¹åº”ç”¨é…ç½®æ–‡ä»¶ï¼Œ/etc/nginx/conf.d/ ä¸‹ä¸ä¹‹å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼Œä¿®æ”¹åé‡å¯ nginx å°±èƒ½å¤Ÿä½¿æ–°çš„ ngxin é…ç½®ç”Ÿæ•ˆäº†ã€‚
